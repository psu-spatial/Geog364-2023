<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Lab 2: Playing with data</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>










<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">GEOG 364 Lab Book</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="in_Tutorial01WhatisR.html">1. What is R?</a>
    </li>
    <li>
      <a href="in_Tutorial02SetUp.html">2. General Set-Up</a>
    </li>
    <li>
      <a href="in_Tutorial03LabSetUp.html">3. Lab Set-Up</a>
    </li>
    <li>
      <a href="in_Tutorial04ConsoleBasics.html">4. Console Basics</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="in_G364_Lab0_FAQ.html">Lab FAQ</a>
    </li>
    <li>
      <a href="in_G364_Lab1_2324.html">Lab 1</a>
    </li>
    <li>
      <a href="in_G364_Lab2_Basics.html">Lab 2</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Lab 2: Playing with data</h1>
<h3 class="subtitle"><h4 style="font-style:normal"><br />
This is a two week lab. If you are new to R, I suggest doing the
data-camp, set-up and frost analysis this week, then next week starting
the UFO analysis.<br />
</h4></h3>

</div>


<style>
p.comment {
background-color: #DBDBDB;
padding: 10px;
border: 1px solid black;
margin-left: 0px;
border-radius: 5px;
font-style: normal;
}

h1.title {
  font-weight: bold;
  font-family: Arial;  
}

h2.title {
  font-family: Arial;  
}

</style>
<style type="text/css">
#TOC {
  font-size: 12px;
  font-family: Arial;
}
</style>
<p><br />
</p>
<p>The aim of this lab is to start some spatial data analysis and to
recap what you learned in Lab 1. By the end of this lab you will be able
to:</p>
<ul>
<li><p>Prove to me you can set up the labs</p></li>
<li><p>Read in data from an excel file and a spatial file</p></li>
<li><p>Conduct exploratory data analysis</p></li>
<li><p>Wrangle a table of data</p></li>
<li><p>Make initial plots and maps for two case studies <br></p></li>
</ul>
<p>See <a
href="https://psu.instructure.com/courses/2260204/assignments/15480985">The
Canvas page here</a>, or go to canvas for assignment guidelines. You can
use either the website base RStudio/Posit Cloud OR R-Desktop for this
lab</p>
<p><br><br><br></p>
<div id="data-camp" class="section level1">
<h1>Data Camp</h1>
<p>IMPORTANT, Click this link to be added (for free) to the class
datacamp. You will need to have signed up using your PSU address</p>
<ul>
<li><a
href="https://www.datacamp.com/groups/shared_links/09c662a03e00d0ac23e6716894266ef2f72c4cee048f1b1da99c0f9440584976"
class="uri">https://www.datacamp.com/groups/shared_links/09c662a03e00d0ac23e6716894266ef2f72c4cee048f1b1da99c0f9440584976</a>
<br><br></li>
</ul>
<div id="optional-but-highly-recommended-for-newbies"
class="section level4">
<h4>1. Optional but highly recommended for newbies</h4>
<p>If you felt lost during week 1, I highly recommend completing chapter
1 of this data camp course. It will help you understand the next bit of
the analysis. It’s free if you signed up using the link above.</p>
<ul>
<li><a
href="https://app.datacamp.com/learn/courses/free-introduction-to-r"
class="uri">https://app.datacamp.com/learn/courses/free-introduction-to-r</a></li>
</ul>
<p>I will award 5 participation points for anyone who completes chapter
1.</p>
<p><br><br><br></p>
</div>
</div>
<div id="getting-started" class="section level1">
<h1>Getting started</h1>
<div id="create-your-project" class="section level2">
<h2>2. Create your project</h2>
<ol style="list-style-type: decimal">
<li><p><strong>Create a new project in R for Lab 2 and make sure it’s in
your GEOG 364 folder.</strong></p>
<ul>
<li><p>For R-Desktop, see <a
href="https://psu-spatial.github.io/Geog364-2023/in_Tutorial03LabSetUp.html#Projects_using_Desktop">Tutorial
3B</a></p></li>
<li><p>For Posit Cloud, see <a
href="https://psu-spatial.github.io/Geog364-2023/in_Tutorial03LabSetUp.html#Projects_using_Rstudioposit_Cloud">Tutorial
3C</a> <br><br></p></li>
</ul></li>
<li><p>Take a screenshot of R studio screen that <em>proves</em> you
have set up your project correctly</p>
<ul>
<li>Hint, <a
href="https://psu-spatial.github.io/Geog364-2023/in_Tutorial03LabSetUp.html#How_to_check_you_are_in_a_project">how
to check you are in a project</a>) <br><br> To take a screenshot on a
mac: <em>Press <strong><code>Shift + Command (⌘) + 4</code></strong>.
Your cursor will change to a crosshair. Click and drag to select the
portion of the screen you want to capture. Release the mouse button to
take the screenshot. It will be saved to your desktop. Re-name the file
and move to your GEOG-364 Lab 2 folder.</em> <br><br> To take a
screenshot on a windows machine, try one of these or ask around/Harman:
<em>Press *<strong><code>Windows key + Shift + S</code></strong> . This
is the <a
href="https://support.microsoft.com/en-us/windows/use-snipping-tool-to-capture-screenshots-00246869-1843-655f-f220-97299b865f6b">snipping
tool</a>.</em> <em>On older machines, try
<strong><code>Windows Logo Key + PrtScn.</code></strong></em>
<em>Re-name the file and move to your GEOG-364 Lab 2 folder.</em></li>
</ul></li>
</ol>
<p><br></p>
</div>
<div id="get-the-files" class="section level2">
<h2>3. Get the files</h2>
<p><u>Download these three files from <a
href="https://psu.instructure.com/courses/2260204/assignments/15480985">Canvas</a>
and place them in your lab 2 folder.</u> <br><br />
If you are on the cloud, <a
href="https://psu-spatial.github.io/Geog364-2023/in_Tutorial03LabSetUp.html#Uploading_files">here
is how to upload files</a>:</p>
<ul>
<li><p>The lab template</p></li>
<li><p>The frost data</p></li>
<li><p>Your PERSONAL UFO dataset <br><br />
(<em>f this doesn’t work or you can’t find your file, there’s no panic.
Let Harman know - we will get it fixed by the end of the
day</em></p></li>
</ul>
<p><br></p>
</div>
<div id="edit-your-template" class="section level2">
<h2>4. Edit your template</h2>
<p>Rather than create a new markdown file, this week I want you to use a
template that I made. You should have just downloaded this from Canvas.
Make sure it’s in your Lab 2 folder and you’re running your project.
<br></p>
<ol style="list-style-type: decimal">
<li><p>Go to the file quadrant and click the G364_Lab 2 Template.Rmd
file.<br><br></p></li>
<li><p>You will hopefully see a little yellow bar asking you to install
some libraries/package. Say yes. Alternatively, use the <a
href="https://psu-spatial.github.io/Geog364-2023/in_Tutorial03LabSetUp.html#Downloading_a_new_package">install
package command</a> you used last week to install the sp, sf, tmap,
tidyverse and readxl packages.</p></li>
<li><p>Click “<a
href="https://psu-spatial.github.io/Geog364-2023/in_Tutorial03LabSetUp.html#Visual_mode">visual</a>”
mode. Your screen should now look like the screenshot below. If not, ask
for help<br><br></p></li>
<li><p>Click knit. You might have to re-save. Make sure to include your
ID in the filename. You should see the html appear. <br><br></p></li>
<li><p>Go back to R studio.</p>
<ul>
<li>In the Set-Up section, explain to me what an R project is in the
text and include your screenshot, explaining how it proves you are
running your Lab 2 project.</li>
<li>Hint, to include a picture, click the visual mode picture button
(see circle in pic above).<br><br></li>
</ul></li>
</ol>
<p><img src="Figures/Lab2Fig1_SetUp.png" width="1680" /></p>
<p><br><br></p>
</div>
<div id="libraries" class="section level2">
<h2>5. Libraries</h2>
<p>Last week we downloaded the rmdformats package. In the section above,
hopefully you just downloaded several more (step 3). This is like going
to the app store to get a new banking app.</p>
<p>Even though they are downloaded, we need to load them EVERY TIME we
want to use them (in the way you click on an app on your phone before
you can use it). This is what that library code-chunk does at the start
of the script.</p>
<ul>
<li><p>Press the green arrow on the right of the code chunk to run the
code inside it.&lt;br&gt;You will see a load of “welcome text” telling
your details about the packages you just loaded.&lt;br&gt;Press the
green arrow AGAIN. The text should disappear unless there is an error.
If you get errors, you might <a
href="https://psu-spatial.github.io/Geog364-2023/in_Tutorial03LabSetUp.html#Downloading_a_new_package">still
need to download those packages</a>.</p></li>
<li><p>&lt;br&gt;YOU NEED TO RE-RUN THIS CODE CHUNK EVERY TIME YOU OPEN
R.</p></li>
</ul>
<p><img src="Figures/Lab2Fig2_Libraries.png" width="662" /></p>
<p><br><br><br></p>
</div>
</div>
<div id="frost-analysis" class="section level1">
<h1>Frost Analysis</h1>
<p>Finally some analysis! We are going to conduct some exploratory data
analysis on average last spring frost dates across the South East
USA.</p>
<p>To to this, we are going to follow these steps:</p>
<ul>
<li>Investigate the topic before touching the data</li>
<li>Read the excel file containing the data into R</li>
<li>Calculate summary statistics and “wrangle” the data</li>
<li>Make some initial plots &amp; maps</li>
</ul>
<p><br></p>
<div id="exploratory-investigations" class="section level2">
<h2>6: Exploratory Investigations</h2>
<p><em>Before we touch any data, it’s important to start with words. We
need to summarise what we already know about the dataset, the population
under study and any important context.</em></p>
<p>The aim of this lab is to analyse the “average last frost dates”
obtained from weather stations across the South Eastern USA. E.g. what
day of year, <em>on average</em>, is the final day to get frost. We are
using data obtained from this dissertation to assess the spatial
distribution of average spring frost dates: <em>Parnell, 2005, “A
Climatology of Frost Extremes Across the Southeast United States,
1950–2009”:</em><br> <a
href="https://www.proquest.com/openview/d5a7301f0cbe941ead48c96888f791b8/1?pq-origsite=gscholar&amp;cbl=18750&amp;diss=y"
class="uri">https://www.proquest.com/openview/d5a7301f0cbe941ead48c96888f791b8/1?pq-origsite=gscholar&amp;cbl=18750&amp;diss=y</a></p>
<ul>
<li><p>Read the abstract of the study above to understand the dataset
<em>(click the link and skim read pages iv and v, e.g. the bit before
the table of contents)</em>.</p></li>
<li><p>Write a few sentences in the appropriate section of your lab
report to explain what we are doing.</p></li>
</ul>
<p><br><br></p>
</div>
<div id="load-the-data" class="section level2">
<h2>7: Load the data</h2>
<p>I have already provided the command to load the data into R. Press
the green arrow to run. This will only work if you have run your library
code chunk, if your file really is in your lab 2 folder and if you have
downloaded the readxl library.</p>
<p>You should see the data appear in the ‘environment tab’. Click the
NAME to take a look.</p>
<p><br><br></p>
</div>
<div id="intro-analysis" class="section level2">
<h2>8: Intro analysis</h2>
<p>Being added in next 10mins. REFRESH THE PAGE!</p>
<p><br><br><br></p>
</div>
</div>
<div id="d.-ufo-analysis" class="section level1">
<h1>D. UFO Analysis</h1>
<p>To be added later today. Focus on sections A-C for now - and you have
all lab next week for this part.</p>
<p><br><br><br></p>
</div>
<div id="e.-submitting-your-lab" class="section level1">
<h1>E. Submitting your Lab</h1>
<p>Remember to save your work throughout and to spell check! (next to
the save button). Now, press the knit button one final time.</p>
<p>On R-Desktop</p>
<ul>
<li><p>If you have not made any mistakes in the code then R should
create a html file in your lab 2 folder which includes your
answers.</p></li>
<li><p>If you look at your lab 2 folder on your computer, you should see
this there - complete with a very recent time-stamp. Double click on the
html file. This will open it in your web-browser.<br />
CHECK THAT THIS IS WHAT YOU WANT TO SUBMIT.<br></p></li>
</ul>
<p>On Rstudio cloud,</p>
<ul>
<li>See <a
href="https://psu-spatial.github.io/Geog364-2023/in_Tutorial03LabSetUp.html#Projects_using_Rstudioposit_Cloud">TUTORIAL
3 Cloud - LINK FIXED</a> for how to download your files <br></li>
</ul>
<p>Finally, go to Canvas and submit BOTH your html and your .Rmd file in
Lab 2.</p>
<p><img src="Figures/LabFig_WhatToSubmit.png" width="1673" /></p>
<p><br><br></p>
<div id="e1.-how-am-i-graded" class="section level2">
<h2>E1. How am I graded?</h2>
<p>Look on Canvas, there will be a SPECIFIC RUBRIC that we use to grade
your lab. It should allow you to predict your grade. We will also
include comments with our feedback in every lab.</p>
<p>Overall, here is what your lab should correspond to:</p>
<table class=" lightable-classic-2 table table-striped table-hover table-responsive" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
POINTS
</th>
<th style="text-align:left;">
Approx grade
</th>
<th style="text-align:left;">
What it means
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
98-100
</td>
<td style="text-align:left;">
A*
</td>
<td style="text-align:left;">
Exceptional.  Above and beyond.  THIS IS HARD TO GET.
</td>
</tr>
<tr>
<td style="text-align:left;">
93-98
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
Everything asked for with high quality.   Class example
</td>
</tr>
<tr>
<td style="text-align:left;">
85-93
</td>
<td style="text-align:left;">
B+/A-
</td>
<td style="text-align:left;">
Solid work but the odd mistake or missing answer in either the code or
interpretation
</td>
</tr>
<tr>
<td style="text-align:left;">
70-85
</td>
<td style="text-align:left;">
B-/B
</td>
<td style="text-align:left;">
Starting to miss entire/questions sections, or multiple larger mistakes.
Still a solid attempt. 
</td>
</tr>
<tr>
<td style="text-align:left;">
60-70
</td>
<td style="text-align:left;">
C/C+
</td>
<td style="text-align:left;">
It’s clear you tried and learned something.  Just attending labs will
get you this much as we can help you get to this stage
</td>
</tr>
<tr>
<td style="text-align:left;">
40-60
</td>
<td style="text-align:left;">
D
</td>
<td style="text-align:left;">
You submit a single word AND have reached out to Dr G or Aish for help
before the deadline (make sure to comment you did this so we can check)
</td>
</tr>
<tr>
<td style="text-align:left;">
30-40
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
You submit a single word……. ANYTHING.. Think, that’s 30-40 marks towards
your total….
</td>
</tr>
<tr>
<td style="text-align:left;">
0+
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Didn’t submit, or incredibly limited attempt. 
</td>
</tr>
</tbody>
</table>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
