<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Dr Greatrex" />

<meta name="date" content="2023-12-05" />

<title>GEOG 364 Project Final</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">GEOG 364 Lab Book</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="in_Tutorial01WhatisR.html">1. What is R?</a>
    </li>
    <li>
      <a href="in_Tutorial02SetUp.html">2. General Set-Up</a>
    </li>
    <li>
      <a href="in_Tutorial03LabSetUp.html">3. Lab Set-Up</a>
    </li>
    <li>
      <a href="in_Tutorial04ConsoleBasics.html">4. Console Basics</a>
    </li>
    <li>
      <a href="in_Tutorial05ReadingInData.html">5. Reading in Data</a>
    </li>
    <li>
      <a href="in_Tutorial06DataWrangling.html">6. Data wrangling</a>
    </li>
    <li>
      <a href="in_Tutorial07DataSummaries.html">7. Data summaries</a>
    </li>
    <li>
      <a href="in_Tutorial08Plots.html">8. Plotting data</a>
    </li>
    <li>
      <a href="in_Tutorial09Spatial.html">9. Spatial basics</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="in_G364_Lab0_FAQ.html">Lab FAQ</a>
    </li>
    <li>
      <a href="in_G364_Lab1_2324.html">Lab 1</a>
    </li>
    <li>
      <a href="in_G364_Lab2_Basics.html">Lab 2</a>
    </li>
    <li>
      <a href="in_G364_Lab3_PointPattern.html">Lab 3A</a>
    </li>
    <li>
      <a href="in_G364_Lab3B_PointPatternDist.html">Lab 3B</a>
    </li>
    <li>
      <a href="in_G364_Lab4_Ozone.html">Lab 4</a>
    </li>
    <li>
      <a href="in_G364_Lab5_MoranLisa.html">Lab 5</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Project instructions
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="in_G364_Project2.html">Project 2</a>
    </li>
    <li>
      <a href="in_G364_Project3.html">Project 3</a>
    </li>
    <li>
      <a href="in_G364_Project4.html">Project Final</a>
    </li>
    <li>
      <a href="in_G364_Project_FINALRUBRIC.html">CHECK YOUR PROJECT HAS EVERYTHING</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Project WORKED EXAMPLE
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="in_WorkedExample_Workings.html">Background workings</a>
    </li>
    <li>
      <a href="in_WorkedExample_Report.html">Example Report (up to the end of project 2)</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">GEOG 364 Project Final</h1>
<h4 class="author">Dr Greatrex</h4>
<h4 class="date">2023-12-05</h4>

</div>


<style>
p.comment {
background-color: #DBDBDB;
padding: 10px;
border: 1px solid black;
margin-left: 0px;
border-radius: 5px;
font-style: normal;
}

h1.title {
  font-weight: bold;
  font-family: Arial;  
}

h2.title {
  font-family: Arial;  
}

</style>
<style type="text/css">
#TOC {
  font-size: 12px;
  font-family: Arial;
}

pre code {
  font-size: 13px; /* Adjust the font size as needed */
  white-space: pre-wrap;
}
</style>
<p><br />
</p>
<p>Welcome to the final part of your projects. The aim of this week is
to tidy your reports (following the guidelines below), do one final
analysis and finish up. This is due WEDNESDAY of exams week (see
Canvas).</p>
<p><br><br></p>
<div id="step-0-troubleshooting" class="section level1">
<h1>Step 0| TROUBLESHOOTING</h1>
<p><br></p>
<div id="my-library-code-chunk-doesnt-run" class="section level2">
<h2>My library code chunk doesn’t run</h2>
<p>You might find that if you have updated R, it can’t find a few
packages such as sp. Remove these lines from your library code chunk -
it should then run. If we get errors, Harman and I will help you through
them. The reason for this is the big R update.</p>
<p><br></p>
</div>
<div id="my-code-is-timing-out-or-crashing" class="section level2">
<h2>My code is timing out or crashing</h2>
<p>Especially an issue on the cloud. Follow these steps.</p>
<ol style="list-style-type: decimal">
<li><p>Go to the Files tab or to your folder on your computer. Your
folder should have your .RProj file, your .RmD report, your data, and
any photos/pictures, but no random sub-files. Delete any cache files,
the html file, .md files or random subfolders. <br></p></li>
<li><p>In RStudio in the the Environment tab, click the broom AND/OR
type this into the console rm(list=ls()). This will clear your
variables. <br></p></li>
<li><p>The next step depends on what you are trying to do <br></p>
<ol style="list-style-type: decimal">
<li><p>If you’re trying to knit: <br></p>
<ol style="list-style-type: decimal">
<li><p>Go go to the Session menu at the very top of the
screen.<br></p></li>
<li><p>Click Restart R and Clear output. <br></p></li>
<li><p>Wait for it to finish running. Then press knit.<br></p></li>
<li><p>If it still doesn’t work, talk to a teacher/TA<br><br><br />
</p></li>
</ol></li>
<li><p>If you’re trying to write/run code,: <br></p>
<ol style="list-style-type: decimal">
<li><p>Go to the session menu at the very top. <br></p></li>
<li><p>Click Restart R and run all code chunks. <br></p></li>
<li><p>Wait for it to run, then continue. If it gets stuck on a code
chunk, carefully read/respond to that error.<br></p></li>
</ol></li>
</ol></li>
</ol>
<p><br><br></p>
</div>
</div>
<div id="step-1-tidying-up-dont-skip" class="section level1">
<h1>Step 1 | Tidying up (DON’T SKIP)</h1>
<p><br></p>
<div id="clear-your-workspace" class="section level2">
<h2>1.1 | Clear your workspace</h2>
<p><br></p>
<p>First, let’s clear your workspace &amp; headspace<br></p>
<ul>
<li>Make sure all is saved. Close Rstudio.<br></li>
<li>Go into your project folder, and open the R-Studio project (the
.RProj file NOT the RmD).<br></li>
<li>In the environment tab, click the broom. AND/OR type this into the
console <code>rm(list=ls())</code><br></li>
<li>Go to the session menu at the very top. Click Restart R and run all
code chunks.<br></li>
</ul>
<p>This should clear your workspace and run everything in your project.
<br></p>
<p>Click knit. If this knitted before, it should knit now! If it doesn’t
knit, then run all the code chunks and see where the error is. Often
it’s because you imported some data without actually writing the command
in your code. <br></p>
<p>Click “Run All” code chunks.</p>
<p><br><br></p>
</div>
<div id="what-should-you-have" class="section level2">
<h2>1.2 | What should you have?</h2>
<p>Make sure you have followed step 1.1 and run your code. Now go to
your environment tab.</p>
<ul>
<li><p>Find the variable containing your sf data (e.g. your spatial
point data). Ideally choose the utm one, but either this or the sf
long/lat one is OK. e.g. market.sf.utm <br></p></li>
<li><p>In your Environment Tab, click on the text of the NAME ITSELF of
your data in the environment tab (not the little arrow) to open the data
in a new tab. OR in the CONSOLE, type View(XXXX) where XXXX is your
variable name.</p></li>
<li><p><br></p></li>
</ul>
<p>Look at your data. You should have at least one of these scenarios:
<br></p>
<div
id="scenario-ayou-have-a-point-or-polygon-dataset-with-multiple-numeric-columns-of-marks."
class="section level4">
<h4><u><strong>Scenario A|</strong></u>You have a point OR polygon
dataset with <em>multiple</em> numeric columns of marks.</h4>
<p>What do I mean?</p>
<ul>
<li><p>A column of numbers with actual meaning for each point. E.g.
Elevation, Age, Length, Percentage in Poverty, average temperature…
<br></p></li>
<li><p>DO NOT COUNT THESE TYPES OF COLUMNS</p>
<ul>
<li>dates, spatial-coordinates, “descriptive numeric columns” (e.g. zip
codes, or unique-keys), or categorical data (e.g. year of school), ocean
depth… <br></li>
</ul></li>
</ul>
<p>If you have more than 1 numeric column in a point or polygon dataset,
go straight to Step 2.</p>
<p><br><br></p>
</div>
<div
id="scenario-byou-have-a-point-or-polygon-dataset-but-you-only-have-one-numeric-column."
class="section level4">
<h4><u><strong>Scenario B|</strong></u>You have a point OR polygon
dataset but you only have ONE numeric column.</h4>
<p>For now, send Dr G a Canvas message,</p>
<ul>
<li><p>OR try adding the average weather conditions (Follow the actual
tutorial in this link e.g. scroll down and use my code, don’t click on
the outside tutorial links <a
href="https://psu-spatial.github.io/Geog364-2021/364Data_TutorialDownload.html#Weather_data"
class="uri">https://psu-spatial.github.io/Geog364-2021/364Data_TutorialDownload.html#Weather_data</a>)</p></li>
<li><p>OR if you are on land and you don’t have elevation, add
that.</p></li>
</ul>
<p><br><br></p>
</div>
</div>
</div>
<div id="step-2-relationships-between-marks" class="section level1">
<h1>Step 2 | Relationships between marks</h1>
<p>Create a new Heading at the end of your report called Regression.</p>
<p><br></p>
<div id="choose-your-columns" class="section level2">
<h2>2.1. Choose your columns</h2>
<p>Choose two numeric columns/marks/variables that you think might be
related in your dataset. E.g. Percentage BroadbandAccess and Poverty
Level. Make a note of the exact spelling of the column names.</p>
<p>Ideally these will be linked somehow to the aim of your report, but
if you end up looking at ‘nonsense variables’ like the elevation vs UFO
“length of sighting” that’s OK, you won’t lose marks.</p>
<p><br></p>
</div>
<div id="designate-a-predictor-and-response" class="section level2">
<h2>2.2. Designate a Predictor and Response</h2>
<p>We want to assess whether one mark ‘causes’ the other one. E.g. “I
think <em>percent</em>_<em>poverty</em> ‘causes’ lower
<em>percent</em>_<em>broadband_access</em> for zip codes in Florida”, or
“I think <em>Elevation</em> causes changes in <em>Sighting_Length</em>
for point-based UFO sightings”.</p>
<ul>
<li><p>So in your report text, assign one variable/column to be your
“predictor” e.g. in this case, I would choose
<em>percent</em>_<em>poverty</em>, or <em>Elevation</em></p></li>
<li><p>And assign the other one as your “response” e.g. my report might
be about <em>percent</em>_<em>broadband_access</em> access, or
<em>Sighting_Length</em>.</p></li>
</ul>
<p>Now see if you can come up with some story about WHY one might cause
the other.</p>
<p>For example - “higher elevations mean clearer skies and longer UFO
sightings”. Or “poorer neighbourhoods are less likely to have
infrastructure spending and so less likely to have good internet
speeds”. Write both your choices and the story you think links them into
your report. Below, we will explore these variables.</p>
<p><br></p>
</div>
<div id="make-some-histograms" class="section level2">
<h2>2.3. Make some histograms</h2>
<p><br></p>
<p>Make good looking histograms of EACH of your response and predictor
variables. I suggest either the ggplot version or the gghistostats
version at the end of this tutorial.</p>
<p><a
href="https://psu-spatial.github.io/Geog364-2023/in_Tutorial08Plots.html#Histograms"
class="uri">https://psu-spatial.github.io/Geog364-2023/in_Tutorial08Plots.html#Histograms</a></p>
<p>In your report, describe the distribution of each of your variables
e.g. describe the shape of the histograms. You ideally want this to look
<em>roughly</em> like a normal distribution. It’s OK if it’s
super-skewed<a href="#fn1" class="footnote-ref"
id="fnref1"><sup>1</sup></a>, but don’t have things that are super weird
(e.g. all 1s and 0s or all the same number).</p>
<p>We are going to use the ggplotly package. Follow THIS TUTORIAL to
make a scatterplot comparing your two variables. <a
href="https://psu-spatial.github.io/Geog364-2023/in_Tutorial08Plots.html#Interactive"
class="uri">https://psu-spatial.github.io/Geog364-2023/in_Tutorial08Plots.html#Interactive</a>.
Remember:</p>
<ul>
<li><p>You will need library(plotly)</p></li>
<li><p>Your response is the y variable (vertical axis)</p></li>
<li><p>Your predictor is the x variable (horizontal axis)</p></li>
</ul>
<p><br></p>
</div>
<div id="make-some-maps" class="section level2">
<h2>2.4. Make some maps</h2>
<p>Make a good looking QTM/tmap map of each of your variables. Here’s
example code for both options (you will have one type or the other).</p>
<ul>
<li><p>If you have point data, the option dots.col=“COLNAME”, allows you
to color in the points to show your variable.</p></li>
<li><p>If you have polygon data, the option col=“COLNAME” allows you to
color in each polygon to show your variables.</p></li>
</ul>
<p><img src="Figures/Report_Fig4D_MapCode.png" width="934" /></p>
<p><br></p>
<p>In the text, describe the relationship two maps within the context of
your report/topic. e.g. does it look like both your response and
predictor are higher in the North? By some major cities? Do they “go
together” e.g. areas where one is high the other is high?. Any
differences across your map?</p>
<p>Now update your story/prediction about the relationship between the
two variables. E.g. from this exploratory analysis I NOW believe
that….</p>
<p><br><br></p>
</div>
</div>
<div id="step-3-regression" class="section level1">
<h1>Step 3 | Regression</h1>
<div id="scatterplots" class="section level2">
<h2>3.1. Scatterplots</h2>
<p>Now we will formally look at the relationship between the two
variables. Go to your library code chunk at the top and add/run. You
might need to install them.</p>
<ul>
<li><code>library(ggplot2)</code></li>
<li><code>library(hrbrthemes)</code></li>
</ul>
<p>Go back to the end of your code. To make a nice scatterplot, use this
code but update the TABLENAME to the variable name of your sf data (e.g.
market.sf), and RESPONSE / PREDICTOR to the column names of your
response and predictor columns.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># Move these to your library code chunk at the top.</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">ggplot</span>(TABLENAME, <span class="fu">aes</span>(<span class="at">x=</span>PREDICTOR, <span class="at">y=</span>RESPONSE)) <span class="sc">+</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>()</span></code></pre></div>
<p>Does the relationship between your predictor and your response match
your story/prediction? Any odd outliers? Is the relationship roughly
linear? Or does it look more like the datasaurus we talked about in the
regression data. For ideas on wording, see here: <a
href="https://www.khanacademy.org/math/ap-statistics/bivariate-data-ap/scatterplots-correlation/a/describing-scatterplots-form-direction-strength-outliers"
class="uri">https://www.khanacademy.org/math/ap-statistics/bivariate-data-ap/scatterplots-correlation/a/describing-scatterplots-form-direction-strength-outliers</a></p>
<p><br><br></p>
</div>
<div id="linear-regressionline-of-best-fit" class="section level2">
<h2>3.2. Linear regression/line of best fit</h2>
<p>We will now fit a linear regression model to the data. Use this code,
but update the TABLENAME to the variable name of your sf data (e.g.
market.sf), and RESPONSE / PREDICTOR to the column names of your
response and predictor columns.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>LinearFit <span class="ot">&lt;-</span> <span class="fu">lm</span>(RESPONSE <span class="sc">~</span> PREDICTOR, <span class="at">data =</span> TABLENAME, <span class="at">na.action=</span><span class="st">&quot;na.exclude&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>TABLENAME<span class="sc">$</span>ModelledOutput   <span class="ot">&lt;-</span> <span class="fu">predict</span>(LinearFit)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>TABLENAME<span class="sc">$</span>Linear.Residuals <span class="ot">&lt;-</span> <span class="fu">residuals</span>(LinearFit)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co"># with linear trend</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="fu">ggplot</span>(TABLENAME, <span class="fu">aes</span>(<span class="at">x=</span>PREDICTOR, <span class="at">y=</span>RESPONSE)) <span class="sc">+</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm , <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>()</span></code></pre></div>
<p><br></p>
<p>Given your visual inspection, write whether you you happy with your
linear model. For example, does it seem to do a good job of capturing
the relationship between your variables?<a href="#fn2"
class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<p><br></p>
<p>We can have a look at the line of best fit by simply typing/running
the linear fit name. <code>summary(LinearFit)</code> gives a load more
statistics. This will give you the intercept and the gradient.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>LinearFit</span></code></pre></div>
<p>Use these notes to write out the equation for the line of best fit in
your report.</p>
<p><a
href="https://online.stat.psu.edu/stat200/lesson/12/12.3#paragraph--2822"
class="uri">https://online.stat.psu.edu/stat200/lesson/12/12.3#paragraph--2822</a></p>
<p>You can either do this manually, or use insert Equation. (hint, the
little hat means <em>estimated/modelled</em> weight<em>).</em></p>
<p><br><br></p>
</div>
<div id="understandingmapping-your-output" class="section level2">
<h2>3.3. Understanding/mapping your output</h2>
<p>Finally, we can look at maps of the ACTUAL response, the MODELLED
response (line of best fit), and the “residuals”. Remind yourself on
what is going on here: <a
href="https://www.khanacademy.org/math/ap-statistics/bivariate-data-ap/xfb5d8e68:residuals/v/residual-plots"
class="uri">https://www.khanacademy.org/math/ap-statistics/bivariate-data-ap/xfb5d8e68:residuals/v/residual-plots</a>
and in the plot below.</p>
<p>A positive residual means that the actual value was HIGHER than
predicted. A negative residual means the actual value was LOWER than
predicted.</p>
<p><br></p>
<p><img src="Figures/Report_Fig5_regression.png" width="473" /></p>
<p><br></p>
<p>The maps below will only work if you used the sf version of your data
in the regression code, not the raw data (e.g. use the .sf or .utm one).
Again change TABLENAME and RESPONSE to match your data:</p>
<ul>
<li>If you have point data, edit this code</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># your actual response variable observations</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">qtm</span>(TABLENAME,<span class="at">dots.col =</span> <span class="st">&quot;RESPONSE&quot;</span> , <span class="at">fill.palette=</span><span class="st">&quot;Blues&quot;</span>) <span class="sc">+</span> </span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co"># the value of your model at each location e.g. what does the line of best fit suggest </span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="fu">qtm</span>(TABLENAME,<span class="at">dots.cot =</span> <span class="st">&quot;ModelledOutput&quot;</span>,<span class="at">fill.palette=</span><span class="st">&quot;Blues&quot;</span>) <span class="sc">+</span> </span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co"># the residuals </span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="fu">qtm</span>(TABLENAME,<span class="at">dots.cot =</span> <span class="st">&quot;Linear.Residuals&quot;</span>,<span class="at">fill.palette=</span><span class="st">&quot;-RdBu&quot;</span>) <span class="sc">+</span> </span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><br></p>
<ul>
<li>If you have polygon data, edit this code</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># your ACTUAL response data</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">qtm</span>(TABLENAME,<span class="st">&quot;RESPONSE&quot;</span>,<span class="at">fill.palette=</span><span class="st">&quot;Blues&quot;</span>) <span class="sc">+</span> <span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co"># the value of your line of best fit at each location</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="fu">qtm</span>(TABLENAME,<span class="st">&quot;ModelledOutput&quot;</span>,<span class="at">fill.palette=</span><span class="st">&quot;Blues&quot;</span>) <span class="sc">+</span> <span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co"># the residuals </span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="fu">qtm</span>(TABLENAME,<span class="st">&quot;Linear.Residuals&quot;</span>,<span class="at">fill.palette=</span><span class="st">&quot;-RdBu&quot;</span>) <span class="sc">+</span> </span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><br></p>
<p>In your report, describe what you see. Are there places where the
model does a better job (small residuals), or places where it
over/underestimates? Any clear outliers? For an example of what I mean,
see my analysis here on Chicago broadband: <a
href="https://psu-spatial.github.io/Geog364-2021/pg_364Lab7_Regression_2021.html#Plotting_the_results"
class="uri">https://psu-spatial.github.io/Geog364-2021/pg_364Lab7_Regression_2021.html#Plotting_the_results</a>
<br></p>
<p>Then update your ’story”. E.g. I NOW believe that…</p>
<p><br><br></p>
</div>
<div id="autocorrelation-of-residuals" class="section level2">
<h2>3.4 Autocorrelation of residuals</h2>
<p><br></p>
<p>In your pre-req, you learned that statistics is meant to be based on
data that is random, independent and representative. A big problem in
spatial data is that it’s not independent (see Lecture 3) <br></p>
<p>If our regression model is truly independent, then our <em>regression
residuals</em> (what is left over) should not have any influence or
knowledge of each other. Using the maps above, write whether you think
that there is a spatial pattern in your residuals. <br></p>
<p>Now write how you would use a moran’s I and a moran’s
scatterplot/test to assess whether this is true or not. For an example
of what I mean where I did to the analysis, see here: <a
href="https://psu-spatial.github.io/Geog364-2021/pg_364Lab7_Regression_2021.html#Looking_for_Spatial_autocorrelation_in_residuals"
class="uri">https://psu-spatial.github.io/Geog364-2021/pg_364Lab7_Regression_2021.html#Looking_for_Spatial_autocorrelation_in_residuals</a>
<br></p>
<p><u><strong>YOU DO NOT HAVE TO ACTUALLY DO THIS</strong></u>. But use
that example and your lab 5 to explain what you <em>would</em> do in the
text and how you would make sure any pattern wasn’t simply random chance
and your imagination. <br></p>
<p><br><br></p>
</div>
</div>
<div id="step-4-report-conclusions" class="section level1">
<h1>Step 4 | Report conclusions</h1>
<p>Write a conclusion paragraph to your report under a new heading. In
this summarise, what you found out for your report reader. You do not
have to have answered your initial questions! But summarise what you did
and any interesting results.</p>
<p><br><br></p>
</div>
<div id="step-5-check-your-final-html-report." class="section level1">
<h1>Step 5 | Check your final html report.</h1>
<p><br></p>
<p>This is what I will be grading! Press knit. Look at the resulting
html file. <em>Really read it.</em><br />
Here are ten hints to get full marks in the professional report section
of the rubric.</p>
<p><br></p>
<ul>
<li><p>A. Make sure all photographs are there in the html file.</p>
<ul>
<li>Sometimes they’re not appearing in the final report I grade.
<br></li>
<li>If they’re not appearing, they might be in a different folder.
<br></li>
<li>Or try the <code>knitr::include_graphics()</code> command inside a
code chunk<br></li>
</ul></li>
</ul>
<p><img src="Figures/Report_Fig4_includeImage.png" width="719" /></p>
<p><br></p>
<ul>
<li><p>B. If you quote any numbers in your report, make sure they are to
a reasonable amount of decimal places!</p>
<ul>
<li>It doesn’t make sense to have a nearest neighbour distance to the
nearest mm if your object of analysis represents a building…</li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li><p>C. <u>CAREFULLY</u> do a spell check.</p>
<ul>
<li>The spell check button is next to the save button, but it’s not
great – so it will also flag things like website urls as errors.</li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li><p>D. If you have output you don’t really need (see list below),
then tidy up/delete that code. What do I mean by this?</p>
<ul>
<li><p>Things where you print out an entire column or a table of many
hundred values.<br></p></li>
<li><p>Or where you were copy/pasting my code from labs, but you don’t
actually refer to it in your report. Things like where I showed how to
subset to different columns.<br></p></li>
<li><p>If you’re not sure if it’s important, don’t touch
it.<br></p></li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li><p>E. If you have long package loading outputs or dataset loading
outputs in your report, use code chunk options to suppress those.</p>
<ul>
<li>Click Source View so that you can see the code chunks themselves.
<br><br />
</li>
</ul></li>
<li><p>Instead of this: <br></p></li>
</ul>
<p><img src="Figures/Report_Fig4A_CodeOptions.png" width="681" /></p>
<ul>
<li>Change any problematic output code chunks into this,<br />
</li>
</ul>
<p><img src="Figures/Report_Fig4B_CodeOptions.png" width="682" /></p>
<ul>
<li>Press knit and see if it makes the problematic output go away. If
it’s STILL there (elevatr is sometimes a problem), add
<code>include=FALSE</code>.</li>
</ul>
<p><br><br></p>
<ul>
<li><p><strong>F. Check your white-space</strong></p>
<ul>
<li>If you find your text is appearing next to photos and plots, go back
into your code and put loads of blank lines between your paragraphs,
code-chunks, photos/headings etc. R-studio will ignore too many blank
lines. It messes up if things are too close together!</li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li><p><strong>F. Check your column headings</strong></p>
<ul>
<li>Make sure that you are using Header 1, Header 2, Header 3 styles,
for your headings. Click the outline button on the right - it should be
possible to navigate through your report through the headings and
sub-headings.</li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li><p><strong>G. Add a floating table of contents</strong></p>
<ul>
<li><p>If you don’t have a table of contents, try adding toc: TRUE and
toc_float: TRUE into your YAML code at the top. Something like this,
although yours might have a fancy theme rather than html doc. SPACING
MATTERS!</p></li>
<li><p>If it doesn’t work (some themes don’t have them), or it crashes,
press undo (control-Z) and go back to what you had before</p></li>
</ul></li>
</ul>
<p><img src="Figures/Report_Fig4C_YAMLOptions.png" width="464" /></p>
<p><br></p>
<ul>
<li><p><strong>H. Add citations</strong></p>
<ul>
<li>In the visual view, you can add your citations/references as “insert
footnote”, like we did in Lab 4.</li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li><p><strong>I. Check the rubric!</strong></p>
<ul>
<li>On canvas you will see my rubric of how I will grade your final
report. Go look at it!</li>
<li>Work through the rubric and make sure you have everything, there are
also more suggestions here: <a
href="https://psu-spatial.github.io/Geog364-2023/in_G364_Project_FINALRUBRIC.html"
class="uri">https://psu-spatial.github.io/Geog364-2023/in_G364_Project_FINALRUBRIC.html</a></li>
</ul></li>
</ul>
<p><br></p>
<p><br></p>
</div>
<div id="submitting-your-report" class="section level1">
<h1>Submitting your report</h1>
<p>For project three you will be graded on progress. For example, have
you gotten your report closer to the final rubric, have you downloaded
and merged in additional data files?</p>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p><em>Optional advanced for A* students if it is super
skewed: You can make a log column of the data and use that</em><a
href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>If it doesn’t, don’t panic - this is the entire topic of
STAT462, STAT501 and much of GEOG464! So you don’t need to fix this
here. For those not doing those courses, here’s the notes for future
reference. <a href="https://online.stat.psu.edu/stat501/"
class="uri">https://online.stat.psu.edu/stat501/</a><a href="#fnref2"
class="footnote-back">↩︎</a></p></li>
</ol>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
