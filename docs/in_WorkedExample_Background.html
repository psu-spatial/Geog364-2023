<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Tutorial: Spatial 101</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">GEOG 364 Lab Book</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="in_Tutorial01WhatisR.html">1. What is R?</a>
    </li>
    <li>
      <a href="in_Tutorial02SetUp.html">2. General Set-Up</a>
    </li>
    <li>
      <a href="in_Tutorial03LabSetUp.html">3. Lab Set-Up</a>
    </li>
    <li>
      <a href="in_Tutorial04ConsoleBasics.html">4. Console Basics</a>
    </li>
    <li>
      <a href="in_Tutorial05ReadingInData.html">5. Reading in Data</a>
    </li>
    <li>
      <a href="in_Tutorial06DataWrangling.html">6. Data wrangling</a>
    </li>
    <li>
      <a href="in_Tutorial07DataSummaries.html">7. Data summaries</a>
    </li>
    <li>
      <a href="in_Tutorial08Plots.html">8. Plotting data</a>
    </li>
    <li>
      <a href="in_Tutorial09Spatial.html">9. Spatial basics</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="in_G364_Lab0_FAQ.html">Lab FAQ</a>
    </li>
    <li>
      <a href="in_G364_Lab1_2324.html">Lab 1</a>
    </li>
    <li>
      <a href="in_G364_Lab2_Basics.html">Lab 2</a>
    </li>
    <li>
      <a href="in_G364_Lab3_PointPattern.html">Lab 3A</a>
    </li>
    <li>
      <a href="in_G364_Lab3B_PointPatternDist.html">Lab 3B</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Project instructions
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="in_G364_Project2.html">Project 2</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Tutorial: Spatial 101</h1>
<h3 class="subtitle"><h5 style="font-style:normal"><br />
GEOG-364 - Spatial Analysis<br />
</h4></h3>

</div>


<style>
p.comment {
background-color: #DBDBDB;
padding: 10px;
border: 1px solid black;
margin-left: 0px;
border-radius: 5px;
font-style: normal;
}

h1.title {
  font-weight: bold;
  font-family: Arial;  
}

h2.title {
  font-family: Arial;  
}

</style>
<style type="text/css">
 TOC {
  font-size: 12px;
  font-family: Arial;
}
</style>
<p><br />
</p>
<div id="tutorial-9-spatial-101" class="section level2">
<h2>Tutorial 9: Spatial 101</h2>
<p>JUST WANT A WORKED EXAMPLE? SCROLL TO THE END</p>
<p>This tutorial is all about creating and manipulating spatial data</p>
<ul>
<li><p><a href="#Tut9a_basics"><strong>Tutorial 9A: Spatial
basics</strong></a> <br></p>
<ol style="list-style-type: lower-alpha">
<li><a href="#Tut9aa_whatisit">Why treat spatial differently</a>
<br></li>
<li><a href="#Tut9ab_proj">Map projections</a></li>
</ol>
<p><br></p></li>
<li><p><a href="#Tut9b_vector"><strong>Tutorial 9B: Vector
Data</strong></a> <br></p>
<ol style="list-style-type: lower-alpha">
<li><p><a href="#Tut9ba_mark">Marked data</a> <br></p></li>
<li><p><a href="#Tut9bb_convert">Converting existing data to
“spatial”</a> <br></p></li>
<li><p><a href="#Tut9bc_read">Reading in spatial vector data from
file</a> <br></p></li>
<li><p><a href="#Tut9bd_manip">Manipulating vector data</a>
<br></p></li>
<li><p><a href="#Tut9be_plot">Plotting vector data</a></p></li>
</ol>
<p><br></p></li>
<li><p><a href="#Tut9c_raster"><strong>Tutorial 9C: Raster
data</strong></a></p>
<ol style="list-style-type: lower-alpha">
<li><a href="#Tut9ca_basic">To come!</a></li>
</ol></li>
</ul>
<p><br></p>
<div style="margin-bottom:25px;">

</div>
</div>
<div id="Tut9a_basics" class="section level2">
<h2>Tutorial 9A: Spatial basics</h2>
<p><br></p>
<div id="Tut9aa_whatisit" class="section level3">
<h3>Why treat spatial differently</h3>
<p>Geographical data needs special treatment. As well as standard data
analysis, we need to tell R that our data has a spatial location on the
Earth’s surface. R needs to understand what units our spatial location
is in (e.g. metres, degrees..) and how we want the data to appear on
plots and maps. R also needs to understand the different types of vector
data (e.g. what we mean by a “polygon” or “point”).</p>
<p>To achieve this there are some specialist “spatial” types of data we
need to use and several spatial data packages.</p>
<p>We’re going to split this tutorial by vector and raster (field)
data</p>
<p><br></p>
</div>
<div id="Tut9ab_proj" class="section level3">
<h3>Map Projections</h3>
<p>See here for a great overview: <a
href="https://source.opennews.org/articles/choosing-right-map-projection/"
class="uri">https://source.opennews.org/articles/choosing-right-map-projection/</a></p>
<p>At its simplest, think of our map projections as the “units” of the
x-y-z coordinates of geographic data. For example, here is the same map,
but in two different projections.</p>
<ul>
<li><p>On the left, the figure is in latitiude/longitude in units of
degrees.</p></li>
<li><p>On the right the same map is in UTM. In the UTM system, the Earth
is divided into 60 zones. Northing values are given by the metres north,
or south (in the southern hemisphere) of the equator. Easting values are
established as the number of metres from the central meridian of a
zone.</p></li>
</ul>
<div class="figure" style="text-align: center">
<img src="Figures/fig31_MapProjections.png" alt="*Examples of geographic coordinate systems for raster data (WGS 84; left, in Lon/Lat degrees) and projected (NAD83 / UTM zone 12N; right, in metres), figure from https://geocompr.robinlovelace.net/spatial-class.html*" width="80%" />
<p class="caption">
<em>Examples of geographic coordinate systems for raster data (WGS 84;
left, in Lon/Lat degrees) and projected (NAD83 / UTM zone 12N; right, in
metres), figure from <a
href="https://geocompr.robinlovelace.net/spatial-class.html"
class="uri">https://geocompr.robinlovelace.net/spatial-class.html</a></em>
</p>
</div>
<p>You can see the UTM zone here</p>
<div class="figure" style="text-align: center">
<img src="Figures/fig32_UTM.png" alt="Zone 12N: https://epsg.io/32612" width="45%" />
<p class="caption">
Zone 12N: <a href="https://epsg.io/32612"
class="uri">https://epsg.io/32612</a>
</p>
</div>
<p>Each map projection has a unique numeric code called an EPSG code. To
find them, I tend to use these resources, but in this course I will try
to provide the codes</p>
<ul>
<li>google &amp; reading the dataset documentation</li>
<li><a href="https://epsg.io" class="uri">https://epsg.io</a></li>
<li><a
href="https://mangomap.com/robertyoung/maps/69585/what-utm-zone-am-i-in-"
class="uri">https://mangomap.com/robertyoung/maps/69585/what-utm-zone-am-i-in-</a></li>
</ul>
<p class="comment">
<strong>R is stupid. It has no idea what units or projection your
coordinates are in</strong>
</p>
<p><strong>We need to tell R what units/projection/EPSG code your data
is orginally in</strong></p>
<p><strong>THEN we need to convert it to the units/projection/EPSG we
need for analysis</strong></p>
<p>We will go into how to do this in each tutorial.</p>
<p><br></p>
<div style="margin-bottom:25px;">

</div>
</div>
</div>
<div id="Tut9b_vector" class="section level2">
<h2>Tutorial 9B: Vector Data</h2>
<p>As you know, vector data are “objects” you can “pick up and move
around” on a map. So points, lines, polygons, volumes etc.</p>
<p>There are several families of commands available to manipulate vector
spatial data.</p>
<ul>
<li><strong>sp</strong> : The original spatial package.
<ul>
<li>Find a detailed tutorial here: <a
href="https://rspatial.org/raster/spatial/3-vectordata.html"
class="uri">https://rspatial.org/raster/spatial/3-vectordata.html</a>
<br></li>
</ul></li>
<li><strong>terra</strong> : Another new spatial package that we shall
ignore.
<ul>
<li>Detailed tutorial here: <a
href="https://rspatial.org/terra/spatial/3-vectordata.html"
class="uri">https://rspatial.org/terra/spatial/3-vectordata.html</a>
<br></li>
</ul></li>
<li><strong>sf</strong> : A newer spatial package that fits into the
tidyverse family.
<ul>
<li>Detailed tutorial here: <a
href="https://r-spatial.github.io/sf/articles/sf1.html"
class="uri">https://r-spatial.github.io/sf/articles/sf1.html</a>
<br></li>
</ul></li>
<li><strong>spatstat</strong>: A specific package for point pattern
analysis</li>
</ul>
<p>Spatial data packages are like competing mafia families. Some
commands will only work with one spatial data type, so normally I will
store my spatial data as each type. e.g. I will name my variables:</p>
<ul>
<li>mydata : My raw data (R doesn’t understand this is spatial)</li>
<li>mydata.sp : The sp version of my data</li>
<li>mydata.sf : The sf version of my data</li>
</ul>
<p><br></p>
<div id="Tut9ba_mark" class="section level3">
<h3>a. Marked data</h3>
<p>It is very important to understand whether your spatial data is
“marked”.</p>
<p><strong>Un-marked</strong> vector data means that we just know about
the <em>location</em> of the spatial objects (points, polygons..). For
example, the location of crimes, the location of city boundaries etc. We
can assess if these objects are clustered together, spread out etc..</p>
<p><img src="in_WorkedExample_Background_files/figure-html/unnamed-chunk-1-1.svg" width="2100" /></p>
<p><strong>Marked</strong> vector data has some attribute e.g. we know
some <em>information</em> about each point/polygon. For example, with
our weather station data, we know marks such as the Elevation at each
location, the distance to the ocean and the average last frost date:</p>
<p><img src="in_WorkedExample_Background_files/figure-html/unnamed-chunk-2-1.svg" width="2100" /></p>
<p><br></p>
<div style="margin-bottom:25px;">

</div>
</div>
<div id="Tut9bb_convert" class="section level3">
<h3>b. Converting a data.frame in R to spatial sf</h3>
<p>This is only one route, but it’s the one I use</p>
<div
id="step-1-check-what-columns-your-x-and-y-coordinates-are-stored-in."
class="section level4">
<h4><strong>Step 1: Check what columns your x and y coordinates are
stored in.</strong></h4>
<p>Look at your data! View your data table and note what the column
names your x and y data is stored in. Note, these don’t have to be fancy
spatial names, they can be “elephanT” and “popcorn”.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">head</span>(frost)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Station"],"name":[1],"type":["chr"],"align":["left"]},{"label":["State"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Type_Fake"],"name":[3],"type":["chr"],"align":["left"]},{"label":["Avg_DOY_SpringFrost"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Latitude"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Longitude"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Elevation"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Dist_to_Coast"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"Valley","2":"AL","3":"City","4":"109.88","5":"34.57","6":"-85.62","7":"1020","8":"294.992"},{"1":"Union","2":"AL","3":"City","4":"82.27","5":"32.02","6":"-85.75","7":"440","8":"121.515"},{"1":"Saint","2":"AL","3":"Airport","4":"99.85","5":"34.17","6":"-86.82","7":"800","8":"252.062"},{"1":"Fernandina","2":"FL","3":"City","4":"46.89","5":"30.67","6":"-81.47","7":"13","8":"1.148"},{"1":"Lake","2":"FL","3":"City","4":"60.65","5":"30.18","6":"-82.60","7":"195","8":"62.972"},{"1":"West","2":"GA","3":"City","4":"85.63","5":"32.87","6":"-85.18","7":"575","8":"187.456"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Here, we can see that the data coordinates are in columns called
“Longitude” and “Latitude”.</p>
<p><br></p>
</div>
<div
id="step-2-check-what-map-projections-your-x-and-y-coordinates-are-stored-in."
class="section level4">
<h4><strong>Step 2: Check what map projections your x and y coordinates
are stored in.</strong></h4>
<p>Look at the data inside your x and y columns. Is it
longitude/latitude in degrees? A large number (likely metres in UTM),
something else? Look at the documentation of your data for clues. If you
can find the map projection your data is in then you can google the CRS
code.</p>
<p>If your data is in long/lat degrees, then the CRS code 4326 should
work. (I got that from this pdf: <a
href="https://www.nceas.ucsb.edu/sites/default/files/2020-04/OverviewCoordinateReferenceSystems.pdf"
class="uri">https://www.nceas.ucsb.edu/sites/default/files/2020-04/OverviewCoordinateReferenceSystems.pdf</a>)</p>
<p><br></p>
</div>
<div id="step-3-convert-to-sf-using-the-st_as_sf-command"
class="section level4">
<h4><strong>Step 3 Convert to sf using the st_as_sf
command</strong></h4>
<p><code>st_as_sf (tablename, coords=c(XColumnName,YColumnName),crs=MapProjection)</code></p>
<p>For example for our frost data, here is how I turned it into a sf
spatial data format. From step 2, I know this is in long/lat coordinates
and the crs is 4326.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>frost.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(frost,<span class="at">coords=</span><span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>,<span class="st">&quot;Latitude&quot;</span>),<span class="at">crs=</span><span class="dv">4326</span>)</span></code></pre></div>
<p>Now I can check I did it correctly. Here is my attempt at plotting
the long/lat data directly. It doesn’t look much like the USA!</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">plot</span>(frost<span class="sc">$</span>Longitude,frost<span class="sc">$</span>Latitude)</span></code></pre></div>
<p><img src="in_WorkedExample_Background_files/figure-html/unnamed-chunk-5-1.svg" width="2100" /></p>
<p>But here you can see the shapes of the USA. R has also tried to plot
the marks. All the spatial commands will now work.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">plot</span>(frost.sf)</span></code></pre></div>
<p><img src="in_WorkedExample_Background_files/figure-html/unnamed-chunk-6-1.svg" width="2100" /></p>
<p><br></p>
</div>
<div id="step-4.-check-your-map-projection" class="section level4">
<h4><strong>Step 4. Check your map projection </strong></h4>
<p>There are a LOAD of ways to check the map projection of your data.
Perhaps the easiest are the <code>st_crs</code> and <code>crs</code>
commands:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">st_crs</span>(frost.sf)</span></code></pre></div>
<pre><code>## Coordinate Reference System:
##   User input: EPSG:4326 
##   wkt:
## GEOGCRS[&quot;WGS 84&quot;,
##     ENSEMBLE[&quot;World Geodetic System 1984 ensemble&quot;,
##         MEMBER[&quot;World Geodetic System 1984 (Transit)&quot;],
##         MEMBER[&quot;World Geodetic System 1984 (G730)&quot;],
##         MEMBER[&quot;World Geodetic System 1984 (G873)&quot;],
##         MEMBER[&quot;World Geodetic System 1984 (G1150)&quot;],
##         MEMBER[&quot;World Geodetic System 1984 (G1674)&quot;],
##         MEMBER[&quot;World Geodetic System 1984 (G1762)&quot;],
##         MEMBER[&quot;World Geodetic System 1984 (G2139)&quot;],
##         ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
##             LENGTHUNIT[&quot;metre&quot;,1]],
##         ENSEMBLEACCURACY[2.0]],
##     PRIMEM[&quot;Greenwich&quot;,0,
##         ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
##     CS[ellipsoidal,2],
##         AXIS[&quot;geodetic latitude (Lat)&quot;,north,
##             ORDER[1],
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
##         AXIS[&quot;geodetic longitude (Lon)&quot;,east,
##             ORDER[2],
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
##     USAGE[
##         SCOPE[&quot;Horizontal component of 3D system.&quot;],
##         AREA[&quot;World.&quot;],
##         BBOX[-90,-180,90,180]],
##     ID[&quot;EPSG&quot;,4326]]</code></pre>
<p><br></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># written like this to force the projection command specifically from the raster package</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>raster<span class="sc">::</span><span class="fu">projection</span>(frost.sf)</span></code></pre></div>
<pre><code>## [1] &quot;+proj=longlat +datum=WGS84 +no_defs&quot;</code></pre>
<p>Here we can see that we assigned our data to be in Lat/Long, with a
datum (the shape of the world) of WGS 84 and EPSG/CRS code 4326.</p>
<p>You can use this command on any sf data to check.</p>
<p><br></p>
</div>
<div id="step-5.-assign-a-new-map-projection" class="section level4">
<h4><strong>Step 5. Assign a new map projection </strong></h4>
<p>When we do our plots and analyses, we will often need many layers of
data - for example, our points, state borders, city locations, a raster
map of temperatures..</p>
<p>Chances are each of these layers is stored using different map
projections and units. This means that they won’t plot correctly!</p>
<p>So it’s good practice to make sure all your layers have the same map
projection. We do this using the st_transform command:</p>
<p><code>yoursfvariable &lt;- st_transform (yoursfvariable, crs=NEWNUMBER)</code></p>
<p>E.g apply the st_transform command to your sf data with the new crs,
then assign the output to a variable of the same name to overwrite, or a
new name to create a new version with our new projection.</p>
<p><br></p>
<p>For example, to transform our data to the UTM (the map projection in
meters):</p>
<ol style="list-style-type: decimal">
<li>Go here: <a
href="https://mangomap.com/robertyoung/maps/69585/what-utm-zone-am-i-in-"
class="uri">https://mangomap.com/robertyoung/maps/69585/what-utm-zone-am-i-in-</a>
and choose the zone you want.
<ul>
<li><em>I chose a generic US East Coast zone: UTM Zone: 18N.</em></li>
</ul></li>
<li>You can also choose a “datum” (the shape of the earth’s spheroid).
<ul>
<li><em>For us, let’s always choose <strong>WGS 84</strong></em></li>
</ul></li>
<li>Search for the CRS code of that zone here: <a href="https://epsg.io"
class="uri">https://epsg.io</a> . E.g search
<code>UTM Zone XX WGS 84</code>
<ul>
<li><em>For example for me: <a
href="https://epsg.io/?q=UTM+zone+18N+WGS+84"
class="uri">https://epsg.io/?q=UTM+zone+18N+WGS+84</a></em></li>
<li><em>This brought up code 32618: <a href="https://epsg.io/32618"
class="uri">https://epsg.io/32618</a></em></li>
</ul></li>
<li>Apply the command. Here I made three versions, one with lat/long,
one with UTM and one with a polar stereographic projection. I often add
the projection to the end of the variable name to keep things neat.</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>frost.sf.lonlat <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(frost.sf, <span class="dv">4326</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>frost.sf.utm <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(frost.sf, <span class="dv">32618</span>)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>frost.sf.polar <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(frost.sf, <span class="dv">3995</span>)</span></code></pre></div>
<p><br></p>
<p>Let’s see what we did</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>raster<span class="sc">::</span><span class="fu">projection</span>(frost.sf.lonlat)</span></code></pre></div>
<pre><code>## [1] &quot;+proj=longlat +datum=WGS84 +no_defs&quot;</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># YOU CAN SEE THE MAP UNITS ARE IN METRES!</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">crs</span>(frost.sf.utm)</span></code></pre></div>
<pre><code>## [1] &quot;PROJCRS[\&quot;WGS 84 / UTM zone 18N\&quot;,\n    BASEGEOGCRS[\&quot;WGS 84\&quot;,\n        ENSEMBLE[\&quot;World Geodetic System 1984 ensemble\&quot;,\n            MEMBER[\&quot;World Geodetic System 1984 (Transit)\&quot;],\n            MEMBER[\&quot;World Geodetic System 1984 (G730)\&quot;],\n            MEMBER[\&quot;World Geodetic System 1984 (G873)\&quot;],\n            MEMBER[\&quot;World Geodetic System 1984 (G1150)\&quot;],\n            MEMBER[\&quot;World Geodetic System 1984 (G1674)\&quot;],\n            MEMBER[\&quot;World Geodetic System 1984 (G1762)\&quot;],\n            MEMBER[\&quot;World Geodetic System 1984 (G2139)\&quot;],\n            ELLIPSOID[\&quot;WGS 84\&quot;,6378137,298.257223563,\n                LENGTHUNIT[\&quot;metre\&quot;,1]],\n            ENSEMBLEACCURACY[2.0]],\n        PRIMEM[\&quot;Greenwich\&quot;,0,\n            ANGLEUNIT[\&quot;degree\&quot;,0.0174532925199433]],\n        ID[\&quot;EPSG\&quot;,4326]],\n    CONVERSION[\&quot;UTM zone 18N\&quot;,\n        METHOD[\&quot;Transverse Mercator\&quot;,\n            ID[\&quot;EPSG\&quot;,9807]],\n        PARAMETER[\&quot;Latitude of natural origin\&quot;,0,\n            ANGLEUNIT[\&quot;degree\&quot;,0.0174532925199433],\n            ID[\&quot;EPSG\&quot;,8801]],\n        PARAMETER[\&quot;Longitude of natural origin\&quot;,-75,\n            ANGLEUNIT[\&quot;degree\&quot;,0.0174532925199433],\n            ID[\&quot;EPSG\&quot;,8802]],\n        PARAMETER[\&quot;Scale factor at natural origin\&quot;,0.9996,\n            SCALEUNIT[\&quot;unity\&quot;,1],\n            ID[\&quot;EPSG\&quot;,8805]],\n        PARAMETER[\&quot;False easting\&quot;,500000,\n            LENGTHUNIT[\&quot;metre\&quot;,1],\n            ID[\&quot;EPSG\&quot;,8806]],\n        PARAMETER[\&quot;False northing\&quot;,0,\n            LENGTHUNIT[\&quot;metre\&quot;,1],\n            ID[\&quot;EPSG\&quot;,8807]]],\n    CS[Cartesian,2],\n        AXIS[\&quot;(E)\&quot;,east,\n            ORDER[1],\n            LENGTHUNIT[\&quot;metre\&quot;,1]],\n        AXIS[\&quot;(N)\&quot;,north,\n            ORDER[2],\n            LENGTHUNIT[\&quot;metre\&quot;,1]],\n    USAGE[\n        SCOPE[\&quot;Engineering survey, topographic mapping.\&quot;],\n        AREA[\&quot;Between 78°W and 72°W, northern hemisphere between equator and 84°N, onshore and offshore. Bahamas. Canada - Nunavut; Ontario; Quebec. Colombia. Cuba. Ecuador. Greenland. Haiti. Jamaica. Panama. Turks and Caicos Islands. United States (USA). Venezuela.\&quot;],\n        BBOX[0,-78,84,-72]],\n    ID[\&quot;EPSG\&quot;,32618]]&quot;</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">crs</span>(frost.sf.polar)</span></code></pre></div>
<pre><code>## [1] &quot;PROJCRS[\&quot;WGS 84 / Arctic Polar Stereographic\&quot;,\n    BASEGEOGCRS[\&quot;WGS 84\&quot;,\n        ENSEMBLE[\&quot;World Geodetic System 1984 ensemble\&quot;,\n            MEMBER[\&quot;World Geodetic System 1984 (Transit)\&quot;],\n            MEMBER[\&quot;World Geodetic System 1984 (G730)\&quot;],\n            MEMBER[\&quot;World Geodetic System 1984 (G873)\&quot;],\n            MEMBER[\&quot;World Geodetic System 1984 (G1150)\&quot;],\n            MEMBER[\&quot;World Geodetic System 1984 (G1674)\&quot;],\n            MEMBER[\&quot;World Geodetic System 1984 (G1762)\&quot;],\n            MEMBER[\&quot;World Geodetic System 1984 (G2139)\&quot;],\n            ELLIPSOID[\&quot;WGS 84\&quot;,6378137,298.257223563,\n                LENGTHUNIT[\&quot;metre\&quot;,1]],\n            ENSEMBLEACCURACY[2.0]],\n        PRIMEM[\&quot;Greenwich\&quot;,0,\n            ANGLEUNIT[\&quot;degree\&quot;,0.0174532925199433]],\n        ID[\&quot;EPSG\&quot;,4326]],\n    CONVERSION[\&quot;Arctic Polar Stereographic\&quot;,\n        METHOD[\&quot;Polar Stereographic (variant B)\&quot;,\n            ID[\&quot;EPSG\&quot;,9829]],\n        PARAMETER[\&quot;Latitude of standard parallel\&quot;,71,\n            ANGLEUNIT[\&quot;degree\&quot;,0.0174532925199433],\n            ID[\&quot;EPSG\&quot;,8832]],\n        PARAMETER[\&quot;Longitude of origin\&quot;,0,\n            ANGLEUNIT[\&quot;degree\&quot;,0.0174532925199433],\n            ID[\&quot;EPSG\&quot;,8833]],\n        PARAMETER[\&quot;False easting\&quot;,0,\n            LENGTHUNIT[\&quot;metre\&quot;,1],\n            ID[\&quot;EPSG\&quot;,8806]],\n        PARAMETER[\&quot;False northing\&quot;,0,\n            LENGTHUNIT[\&quot;metre\&quot;,1],\n            ID[\&quot;EPSG\&quot;,8807]]],\n    CS[Cartesian,2],\n        AXIS[\&quot;easting (X)\&quot;,south,\n            MERIDIAN[90,\n                ANGLEUNIT[\&quot;degree\&quot;,0.0174532925199433]],\n            ORDER[1],\n            LENGTHUNIT[\&quot;metre\&quot;,1]],\n        AXIS[\&quot;northing (Y)\&quot;,south,\n            MERIDIAN[180,\n                ANGLEUNIT[\&quot;degree\&quot;,0.0174532925199433]],\n            ORDER[2],\n            LENGTHUNIT[\&quot;metre\&quot;,1]],\n    USAGE[\n        SCOPE[\&quot;Polar research.\&quot;],\n        AREA[\&quot;Northern hemisphere - north of 60°N onshore and offshore, including Arctic.\&quot;],\n        BBOX[60,-180,90,180]],\n    ID[\&quot;EPSG\&quot;,3995]]&quot;</code></pre>
<p><img src="in_WorkedExample_Background_files/figure-html/unnamed-chunk-13-1.svg" width="2100" /><img src="in_WorkedExample_Background_files/figure-html/unnamed-chunk-13-2.svg" width="2100" /><img src="in_WorkedExample_Background_files/figure-html/unnamed-chunk-13-3.svg" width="2100" /></p>
<p><br></p>
</div>
<div id="step-6.-make-a-sp-version" class="section level4">
<h4><strong>Step 6. Make a sp version </strong></h4>
<p>Now we have the data in the projection we want, let’s store an sp
version just in case we need it.</p>
<p>To do this we use the “as” command. change the sf format to “Spatial”
(sp) format.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">, I have changed the variable name from sf to sp!</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>frost.sp.lonlat <span class="ot">&lt;-</span> <span class="fu">as</span>(frost.sf.lonlat, <span class="st">&quot;Spatial&quot;</span>)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>frost.sp.utm <span class="ot">&lt;-</span> <span class="fu">as</span>(frost.sf.utm, <span class="st">&quot;Spatial&quot;</span>)</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>frost.sp.polar <span class="ot">&lt;-</span> <span class="fu">as</span>(frost.sf.polar, <span class="st">&quot;Spatial&quot;</span>)</span></code></pre></div>
<p>For some commands, you might get an error using the sf version, so
now you also have a convenient sp version</p>
</div>
<div id="step-7.-all-commands" class="section level4">
<h4><strong>Step 7. ALL COMMANDS </strong></h4>
<p>Here are all the commands in one place for future labs. See how i’m
using code comments to keep things neat.</p>
<pre><code>## [1] &quot;Station&quot;             &quot;State&quot;               &quot;Type_Fake&quot;          
## [4] &quot;Avg_DOY_SpringFrost&quot; &quot;Latitude&quot;            &quot;Longitude&quot;          
## [7] &quot;Elevation&quot;           &quot;Dist_to_Coast&quot;</code></pre>
<p>The advantage of naming them this way is that it’s now really easy to
find stuff in your environment tab. For example I can immediately see
that if I want the latlon sf version of the frost dataset, I would go to
frost.sf.lonlat</p>
<p><img src="Figures/fig33_NamingConventions.png" width="80%" style="display: block; margin: auto;" /></p>
<p><br></p>
<div style="margin-bottom:25px;">

</div>
</div>
</div>
<div id="Tut9bc_read" class="section level3">
<h3>c. Using RNaturalEarth built-in vector datasets</h3>
<p>Let’s now also include some vector-line data on top of our points,
but adding in some regional administrative boundaries. In later labs, we
will learn how to read in vector data from a file, but this time we are
going to use data that is already built into R.</p>
<p>This is part of the <code>rnaturalearth</code> package, which links
automatically with the “Natural Earth” dataset, found here: <a
href="https://www.naturalearthdata.com/features/"
class="uri">https://www.naturalearthdata.com/features/</a></p>
<p>First, download the high-resolution data in rnaturalearth by running
this command in the CONSOLE:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;ropenscilabs/rnaturalearthhires&quot;</span>)</span></code></pre></div>
<p>For administrative border data, we can use the
<code>ne_countries</code> or the <code>ne_states</code>commands.</p>
<p>For example, ne_countries will load the entire world borders and
assign it to a variable called worldborder.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># You can choose if you want the output to be sf or sp data</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>worldborder.sf <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">scale =</span> <span class="st">&quot;medium&quot;</span>, <span class="at">returnclass =</span> <span class="st">&quot;sf&quot;</span>)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co"># st_geometry just means plot the borders</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(worldborder.sf))</span></code></pre></div>
<p><img src="in_WorkedExample_Background_files/figure-html/unnamed-chunk-17-1.svg" width="2100" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># You can choose if you want the output to be sf or sp data</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>UK.country.sf <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">country=</span><span class="st">&quot;united kingdom&quot;</span>,<span class="at">returnclass =</span> <span class="st">&quot;sf&quot;</span>,<span class="at">scale =</span> <span class="st">&quot;medium&quot;</span>)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(UK.country.sf))</span></code></pre></div>
<p><img src="in_WorkedExample_Background_files/figure-html/unnamed-chunk-18-1.svg" width="2100" /></p>
<p>If you want states/regions for your country, you can use the command
<code>ne_states()</code>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># You can choose if you want the output to be sf or sp data</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>UK.regions.sf <span class="ot">&lt;-</span> <span class="fu">ne_states</span>(<span class="at">country=</span><span class="st">&quot;united kingdom&quot;</span>,<span class="at">returnclass =</span> <span class="st">&quot;sf&quot;</span>)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(UK.regions.sf))</span></code></pre></div>
<p><img src="in_WorkedExample_Background_files/figure-html/unnamed-chunk-19-1.svg" width="2100" /></p>
<p>Let’s improve our frost plot</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>US.states.sf <span class="ot">&lt;-</span>  <span class="fu">ne_states</span>(<span class="at">country=</span><span class="st">&quot;united states of america&quot;</span>,<span class="at">returnclass =</span> <span class="st">&quot;sf&quot;</span>)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="co"># Transform to UTM</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>US.states.sf.utm <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(US.states.sf,<span class="at">crs=</span><span class="dv">32618</span>)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(frost.sf.utm),<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(US.states.sf.utm),<span class="at">add=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="in_WorkedExample_Background_files/figure-html/unnamed-chunk-20-1.svg" width="2100" /></p>
<p><br></p>
<div style="margin-bottom:25px;">

</div>
</div>
<div id="Tut9bd_manip" class="section level3">
<h3>d. Manipulating sf data</h3>
<p>Manipulating your spatial data is actually exactly the same as
manipulating your dataframes. You can access columns, filter, select etc
in exactly the same way. You might simply see some additional messages
saying that the data comes from a “spatial” data frame.</p>
<p>For example, to print the first 10 rows:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">head</span>(frost.sf.lonlat)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Station"],"name":[1],"type":["chr"],"align":["left"]},{"label":["State"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Type_Fake"],"name":[3],"type":["chr"],"align":["left"]},{"label":["Avg_DOY_SpringFrost"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Elevation"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Dist_to_Coast"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["geometry"],"name":[7],"type":["sf_POINT"],"align":["right"]}],"data":[{"1":"Valley","2":"AL","3":"City","4":"109.88","5":"1020","6":"294.992","7":"<sf_POINT>"},{"1":"Union","2":"AL","3":"City","4":"82.27","5":"440","6":"121.515","7":"<sf_POINT>"},{"1":"Saint","2":"AL","3":"Airport","4":"99.85","5":"800","6":"252.062","7":"<sf_POINT>"},{"1":"Fernandina","2":"FL","3":"City","4":"46.89","5":"13","6":"1.148","7":"<sf_POINT>"},{"1":"Lake","2":"FL","3":"City","4":"60.65","5":"195","6":"62.972","7":"<sf_POINT>"},{"1":"West","2":"GA","3":"City","4":"85.63","5":"575","6":"187.456","7":"<sf_POINT>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>To filter for just Florida and Alabama stations below 500feet and
save to a new variable</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>frost.FL.sf.lonlat <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(frost.sf.lonlat, State <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;FL&quot;</span>,<span class="st">&quot;AL&quot;</span>))</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>frost.FL.sf.lonlat <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(frost.sf.lonlat, Elevation <span class="sc">&lt;</span> <span class="dv">500</span>)</span></code></pre></div>
<p>To make a table of stations in each state in our new dataset</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">table</span>(frost.FL.sf.lonlat<span class="sc">$</span>State,frost.FL.sf.lonlat<span class="sc">$</span>Type_Fake)</span></code></pre></div>
<pre><code>##     
##      Agricultural_Research_Station Airport City
##   AL                             1       0    1
##   FL                             1       0    5
##   GA                             3       3    5
##   NC                             0       1    7
##   SC                             4       2    3
##   VA                             0       3    0</code></pre>
<p>Or check the maximum elevation in our new dataset</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">max</span>(frost.FL.sf.lonlat<span class="sc">$</span>Elevation)</span></code></pre></div>
<pre><code>## [1] 490</code></pre>
<p><br></p>
<div style="margin-bottom:25px;">

</div>
<hr />
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
