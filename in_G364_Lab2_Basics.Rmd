---
title: "Lab 2: Playing with data"
subtitle: <h4 style="font-style:normal">This is a two week lab. If you are new to R, I suggest doing the data-camp, set-up and frost analysis this week, then next week starting the UFO analysis.</h4>
output: 
  html_document:
    toc: true
    toc_depth: 4
    toc_float: true
    theme: flatly
---

```{=html}
<style>
p.comment {
background-color: #DBDBDB;
padding: 10px;
border: 1px solid black;
margin-left: 0px;
border-radius: 5px;
font-style: normal;
}

h1.title {
  font-weight: bold;
  font-family: Arial;  
}

h2.title {
  font-family: Arial;  
}

</style>
```
```{=html}
<style type="text/css">
#TOC {
  font-size: 12px;
  font-family: Arial;
}
</style>
```
\

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning=FALSE, message = FALSE)
```

```{r,include=FALSE,echo=FALSE}
# invisible data read
library(tidyverse)
library(sp)
library(sf)
library(readxl)
library(skimr)
library(tmap)
library(viridis)
library(kableExtra)

frost <- readxl::read_excel("./Data/DataG364_frostday.xlsx")
```

The aim of this lab is to start some spatial data analysis and to recap
what you learned in Lab 1. By the end of this lab you will be able to:

-   Prove to me you can set up the labs

-   Read in data from an excel file and a spatial file

-   Conduct exploratory data analysis

-   Wrangle a table of data

-   Make initial plots and maps for two case studies <br>

See [The Canvas page
here](https://psu.instructure.com/courses/2260204/assignments/15480985),
or go to canvas for assignment guidelines. You can use either the
website base RStudio/Posit Cloud OR R-Desktop for this lab

<br><br><br>

# Data Camp

IMPORTANT, Click this link to be added (for free) to the class datacamp.
You will need to have signed up using your PSU address

-   <https://www.datacamp.com/groups/shared_links/09c662a03e00d0ac23e6716894266ef2f72c4cee048f1b1da99c0f9440584976>
    <br><br>

#### 1. Optional but highly recommended for newbies

If you felt lost during week 1, I highly recommend completing chapter 1
of this data camp course. It will help you understand the next bit of
the analysis. It's free if you signed up using the link above.

-   <https://app.datacamp.com/learn/courses/free-introduction-to-r>

I will award 5 participation points for anyone who completes chapter 1.

<br><br><br>

# Getting started

## 2. Create your project

1.  **Create a new project in R for Lab 2 and make sure it's in your
    GEOG 364 folder.**

    -   For R-Desktop, see [Tutorial
        3B](https://psu-spatial.github.io/Geog364-2023/in_Tutorial03LabSetUp.html#Projects_using_Desktop)

    -   For Posit Cloud, see [Tutorial
        3C](https://psu-spatial.github.io/Geog364-2023/in_Tutorial03LabSetUp.html#Projects_using_Rstudioposit_Cloud)
        <br><br>

2.  Take a screenshot of R studio screen that *proves* you have set up
    your project correctly

    -   Hint, [how to check you are in a
        project](https://psu-spatial.github.io/Geog364-2023/in_Tutorial03LabSetUp.html#How_to_check_you_are_in_a_project))
        <br><br> To take a screenshot on a mac: *Press
        **`Shift + Command (âŒ˜) + 4`**. Your cursor will change to a
        crosshair. Click and drag to select the portion of the screen
        you want to capture. Release the mouse button to take the
        screenshot. It will be saved to your desktop. Re-name the file
        and move to your GEOG-364 Lab 2 folder.* <br><br> To take a
        screenshot on a windows machine, try one of these or ask
        around/Harman: *Press \***`Windows key + Shift + S`** . This is
        the [snipping
        tool](https://support.microsoft.com/en-us/windows/use-snipping-tool-to-capture-screenshots-00246869-1843-655f-f220-97299b865f6b).*
        *On older machines, try **`Windows Logo Key + PrtScn.`***
        *Re-name the file and move to your GEOG-364 Lab 2 folder.*

<br>

## 3. Get the files

[Download these three files from
[Canvas](https://psu.instructure.com/courses/2260204/assignments/15480985)
and place them in your lab 2 folder.]{.underline} <br>\
If you are on the cloud, [here is how to upload
files](https://psu-spatial.github.io/Geog364-2023/in_Tutorial03LabSetUp.html#Uploading_files):

-   The lab template

-   The frost data

-   Your PERSONAL UFO dataset <br>\
    (*f this doesn't work or you can't find your file, there's no panic.
    Let Harman know - we will get it fixed by the end of the day*

<br>

## 4. Edit your template

Rather than create a new markdown file, this week I want you to use a
template that I made. You should have just downloaded this from Canvas.
Make sure it's in your Lab 2 folder and you're running your project.
<br>

1.  Go to the file quadrant and click the G364_Lab 2 Template.Rmd
    file.<br><br>

2.  You will hopefully see a little yellow bar asking you to install
    some libraries/package. Say yes. Alternatively, use the [install
    package
    command](https://psu-spatial.github.io/Geog364-2023/in_Tutorial03LabSetUp.html#Downloading_a_new_package)
    you used last week to install the sp, sf, tmap, tidyverse and readxl
    packages.

3.  Click
    "[visual](https://psu-spatial.github.io/Geog364-2023/in_Tutorial03LabSetUp.html#Visual_mode)"
    mode. Your screen should now look like the screenshot below. If not,
    ask for help<br><br>

4.  Click knit. You might have to re-save. Make sure to include your ID
    in the filename. You should see the html appear. <br><br>

5.  Go back to R studio.

    -   In the Set-Up section, explain to me what an R project is in the
        text and include your screenshot, explaining how it proves you
        are running your Lab 2 project.
    -   Hint, to include a picture, click the visual mode picture button
        (see circle in pic above).<br><br>

```{r, echo=FALSE}
knitr::include_graphics("./Figures/Lab2Fig1_SetUp.png")
```

<br><br>

## 5. Libraries

Last week we downloaded the rmdformats package. In the section above,
hopefully you just downloaded several more (step 3). This is like going
to the app store to get a new banking app.

Even though they are downloaded, we need to load them EVERY TIME we want
to use them (in the way you click on an app on your phone before you can
use it). This is what that library code-chunk does at the start of the
script.

-   Press the green arrow on the right of the code chunk to run the code
    inside it.\<br\>You will see a load of "welcome text" telling your
    details about the packages you just loaded.\<br\>Press the green
    arrow AGAIN. The text should disappear unless there is an error. If
    you get errors, you might [still need to download those
    packages](https://psu-spatial.github.io/Geog364-2023/in_Tutorial03LabSetUp.html#Downloading_a_new_package).

-   \<br\>YOU NEED TO RE-RUN THIS CODE CHUNK EVERY TIME YOU OPEN R.

```{r, echo=FALSE}
knitr::include_graphics("./Figures/Lab2Fig2_Libraries.png")
```

<br><br><br>

# Frost Analysis

Finally some analysis! We are going to conduct some exploratory data
analysis on average last spring frost dates across the South East USA.

To to this, we are going to follow these steps:

-   Investigate the topic before touching the data
-   Read the excel file containing the data into R
-   Calculate summary statistics and "wrangle" the data
-   Make some initial plots & maps

<br>

## 6: Exploratory Investigations

*Before we touch any data, it's important to start with words. We need
to summarise what we already know about the dataset, the population
under study and any important context.*

The aim of this lab is to analyse the "average last frost dates"
obtained from weather stations across the South Eastern USA. E.g. what
day of year, *on average*, is the final day to get frost. We are using
data obtained from this dissertation to assess the spatial distribution
of average spring frost dates: *Parnell, 2005, "A Climatology of Frost
Extremes Across the Southeast United States, 1950--2009":*<br>
<https://www.proquest.com/openview/d5a7301f0cbe941ead48c96888f791b8/1?pq-origsite=gscholar&cbl=18750&diss=y>

-    Read the abstract of the study above to understand the dataset
    *(click the link and skim read pages iv and v, e.g. the bit before
    the table of contents)*.

-   Write a few sentences in the appropriate section of your lab report
    to explain what we are doing.

<br><br>

## 7: Load the data

I have already provided the command to load the data into R. Press the green arrow to run.

This loads the data stored in "DataG364_frostday.xlsx" into R, then temporarily saves the data into a table called 'frost'

This will only work if 
 - you have run your library code chunk and if you have downloaded the readxl library
 - if your file really is in your lab 2 folder 
 - If you are running your project 
 
Otherwise you will see an error saying it can't find the command.

You should see the frost data appear in the 'environment tab'. Click the NAME to take a look (see screenshot below).  You will see a spreadsheet/table/data.frame with these columns:
  
  - *Station*: The name of the weather station             
  - *State*: The US State that the station resides in   
  - *Type_Fake*: A synthetic column I added to put in a "type" of station
  - *Latitude*: The latitude of the station (degrees)             
  - *Longitude*: The longitude of the station (degrees)      
  - *Elevation*: The elevation of the station (feet)      
  - *Dist_to_Coast*: The distance from the station to the coast (miles)    
  - *Avg_DOY_SpringFrost*: The Day-Of-Year of the average final spring frost date for that station
  
When I say Day-Of-Year, I mean a number from 1-365 representing the month/day of the year e.g. Jan-1:1, Jan-2:2... Jan-31:31, Feb-1:32... Dec-31:365.  We use this number instead of the month/day because its easier to analyse.

<br>


```{r, echo=FALSE}
knitr::include_graphics("./Figures/Lab2Fig3_frost.png")
```

<br><br>



## 8: Intro analysis

Being added in next 10mins. REFRESH THE PAGE!

<br><br><br>

# D. UFO Analysis

To be added later today. Focus on sections A-C for now - and you have
all lab next week for this part.

<br><br><br>

# E. Submitting your Lab

Remember to save your work throughout and to spell check! (next to the
save button). Now, press the knit button one final time.

On R-Desktop

-   If you have not made any mistakes in the code then R should create a
    html file in your lab 2 folder which includes your answers.

-   If you look at your lab 2 folder on your computer, you should see
    this there - complete with a very recent time-stamp. Double click on
    the html file. This will open it in your web-browser.\
    CHECK THAT THIS IS WHAT YOU WANT TO SUBMIT.<br>

On Rstudio cloud,

-   See [TUTORIAL 3 Cloud - LINK
    FIXED](https://psu-spatial.github.io/Geog364-2023/in_Tutorial03LabSetUp.html#Projects_using_Rstudioposit_Cloud)
    for how to download your files <br>

Finally, go to Canvas and submit BOTH your html and your .Rmd file in
Lab 2.

```{r, echo=FALSE}
knitr::include_graphics("./Figures/LabFig_WhatToSubmit.png")
```

<br><br>

## E1. How am I graded?

Look on Canvas, there will be a SPECIFIC RUBRIC that we use to grade
your lab. It should allow you to predict your grade. We will also
include comments with our feedback in every lab.

Overall, here is what your lab should correspond to:

```{r, echo=FALSE}
rubric <- readxl::read_excel("in_G364_Lab0Rubric.xlsx")
knitr::kable(rubric) %>%   
  kable_classic_2() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "responsive"))


```
